<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Clustering</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: row;
            gap: 20px;
        }
        .container {
            flex: 1;
            max-width: 600px;
            padding: 20px;
        }
        .results-section {
            flex: 1;
            margin-top: 20px;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .error-message {
            color: red;
            font-weight: bold;
            margin-bottom: 10px;
        }
        textarea, input {
            width: 100%;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
        }
        button {
            background-color: #007BFF;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .columns {
            display: flex;
            flex-direction: row;
            gap: 20px;
        }
        .column {
            flex: 1;
        }
        .column ul li {
            margin-bottom: 10px;
        }
        h1 {
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Pre-Clustering</h1>
    <div class="columns">
        <div class="column">
            <form method="POST">
                {% if error_message %}
                    <div class="error-message">
                        {{ error_message }}
                    </div>
                {% endif %}
                <label for="vehlist">Enter Vehicle Capacities (comma-separated):</label>
                <textarea id="vehlist" name="vehlist" rows="4" required>{{ vehlist }}</textarea>

                <label for="pers5">Enter Number of 5-person Groups:</label>
                <input type="number" id="pers5" name="pers5" value="{{ pers5 }}" required>

                <label for="pers6">Enter Number of 6-person Groups:</label>
                <input type="number" id="pers6" name="pers6" value="{{ pers6 }}" required>

                <button type="submit">Submit</button>

                <h3>Instructions</h3>
                <p>Please ensure you provide the correct inputs in the form above. For vehicle capacities, enter a comma-separated list of integers (e.g., 4, 5, 8, 10). The number of 5-person and 6-person groups should be positive integers. Make sure you do not include assign together vehicles/crews in this calculation. After pressing submit, it will tell you which crews need additional space organized by largest remaining space. Combine vehicles using the remaining spaces column until you get a "You're all good!" message. The combinations section will only display results if it can find enough pairings of 2 vehicles with extra space that satisfy the shortfall. If you need additional help, refer to <a href="https://google.com" target=\"_blank\">https://google.com</a>.</p>
            </form>
        </div>
    </div>
</div>
<div class="results-section">
    {% if results %}
        <h2>Best Allocation</h2>
        {% if results[1][0] == 0 and results[1][1] == 0 %}
            <p>You're all good!</p>
        {% else %}
            <p><strong>Totals:</strong>
                Total 5-person groups: {{ results[0][0][0] }},
                Total 6-person groups: {{ results[0][0][1] }}
            </p>
            <p><strong>Shortfall:</strong>
                5-person groups: {{ results[1][0] }},
                6-person groups: {{ results[1][1] }}
            </p>
            {% if combos %}
                <p><strong>Combinations:</strong></p>
                {% for vehicle in combos %}
                    <p>Combine Vehicle {{ vehicle[0] }} and Vehicle {{ vehicle[1] }}</p>
                {% endfor %}
            {% else %}
                <p>No combinations available.</p>
            {% endif %}
        {% endif %}
        {% if sorted_allocations %}
            <h2>Sorted Allocation</h2>
            <table border="1" cellspacing="0" cellpadding="5" style="width: 100%; border-collapse: collapse; text-align: center;">
                <thead>
                <tr>
                    <th>Vehicle Number</th>
                    <th>Vehicle Size</th>
                    <th>Sorted Allocation Details</th>
                    <th>Sorted Remaining Spaces</th>
                </tr>
                </thead>
                <tbody>
                {% for entry in sorted_allocations %}
                    <tr>
                        <td>{{ entry[3] }}</td>
                        <td>{{ entry[0] }}</td> <!-- Vehicle size -->
                        <td>
                            {{ entry[1][0] }} 5-person groups, {{ entry[1][1] }} 6-person groups
                        </td>
                        <td>{{ entry[2] }} spaces remaining</td> <!-- Remaining space -->
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p>No sorted allocations to display.</p>
        {% endif %}
    {% else %}
        <p>No results to display. Please check your input and try again.</p>
    {% endif %}
</div>
</body>
</html>
